<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Email Sender Pro</title>
  <link rel="stylesheet" href="styles.css" />
  <!-- Inline favicon to avoid 404 in dev servers -->
  <link rel="icon" href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><defs><linearGradient id="g" x1="0" y1="0" x2="1" y2="1"><stop stop-color="%23667eea"/><stop offset="1" stop-color="%23764ba2"/></linearGradient></defs><rect width="64" height="64" rx="12" fill="url(%23g)"/><path d="M12 18h40c2.2 0 4 1.8 4 4v20c0 2.2-1.8 4-4 4H12c-2.2 0-4-1.8-4-4V22c0-2.2 1.8-4 4-4z" fill="none" stroke="white" stroke-width="4" stroke-linecap="round"/><path d="M56 22L32 38 8 22" fill="none" stroke="white" stroke-width="4" stroke-linecap="round"/></svg>' />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <div class="background-pattern"></div>
  <div class="container">
    <div class="header">
      <div class="logo">
        <div class="logo-icon">
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M4 4H20C21.1 4 22 4.9 22 6V18C22 19.1 21.1 20 20 20H4C2.9 20 2 19.1 2 18V6C2 4.9 2.9 4 4 4Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <polyline points="22,6 12,13 2,6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <h1>Email Sender Pro</h1>
      </div>
      <p class="subtitle">Envie campanhas personalizadas usando diretamente seu Gmail (Senha de App)</p>
    </div>

    <form id="send-form">
      <div class="form-section">
        <div class="section-header">
          <div class="section-icon">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.9 22 6 22H18C19.1 22 20 21.1 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <h3>Arquivo de Dados</h3>
        </div>
        <div class="file-upload-area">
          <input type="file" id="file" name="file" accept=".xlsx" required />
          <label for="file" class="file-upload-label">
            <div class="upload-icon">
              <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <polyline points="7,10 12,15 17,10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <line x1="12" y1="15" x2="12" y2="3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
            <div class="upload-text">
              <span class="upload-title">Clique para selecionar</span>
              <span class="upload-subtitle">Planilha Excel (.xlsx) com colunas "Nome" e "E-mail"</span>
            </div>
          </label>
        </div>
      </div>

      <div class="form-section">
        <div class="section-header">
          <div class="section-icon">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M14.5 4H20C20.5304 4 21.0391 4.21071 21.4142 4.58579C21.7893 4.96086 22 5.46957 22 6V18C22 18.5304 21.7893 19.0391 21.4142 19.4142C21.0391 19.7893 20.5304 20 20 20H4C3.46957 20 2.96086 19.7893 2.58579 19.4142C2.21071 19.0391 2 18.5304 2 18V6C2 5.46957 2.21071 4.96086 2.58579 4.58579C2.96086 4.21071 3.46957 4 4 4H9.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M12 2L14.5 4.5L12 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <h3>Credenciais Gmail (SMTP)</h3>
          <a href="help.html" target="_blank" rel="noopener" class="muted" style="margin-left:auto;text-decoration:underline;color:#667eea">Como obter a Senha de App?</a>
        </div>
        <div class="grid-2" id="smtp_fields">
          <div class="input-group">
            <label for="smtp_user">Seu Gmail</label>
            <input type="email" id="smtp_user" name="smtp_user" placeholder="seuemail@gmail.com" autocomplete="email" required />
          </div>
          <div class="input-group">
            <label for="smtp_pass">Senha de App</label>
            <input type="password" id="smtp_pass" name="smtp_pass" placeholder="16 caracteres sem espaços" autocomplete="current-password" required />
            <div class="input-hint">Gere em myaccount.google.com/apppasswords</div>
          </div>
        </div>
        <div class="grid-2" id="smtp_server_fields">
          <div class="input-group">
            <label for="smtp_server">Servidor SMTP</label>
            <input type="text" id="smtp_server" name="smtp_server" value="smtp.gmail.com" required />
          </div>
          <div class="input-group">
            <label for="smtp_port">Porta</label>
            <input type="number" id="smtp_port" name="smtp_port" value="587" required />
          </div>
        </div>
      </div>

      <div class="form-section">
        <div class="section-header">
          <div class="section-icon">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M14.5 4H20C20.5304 4 21.0391 4.21071 21.4142 4.58579C21.7893 4.96086 22 5.46957 22 6V18C22 18.5304 21.7893 19.0391 21.4142 19.4142C21.0391 19.7893 20.5304 20 20 20H4C3.46957 20 2.96086 19.7893 2.58579 19.4142C2.21071 19.0391 2 18.5304 2 18V6C2 5.46957 2.21071 4.96086 2.58579 4.58579C2.96086 4.21071 3.46957 4 4 4H9.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M12 2L14.5 4.5L12 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <h3>Conteúdo da Mensagem</h3>
        </div>
        <div class="input-group">
          <label for="subject">Assunto</label>
          <input type="text" id="subject" name="subject" placeholder="Digite o assunto do email..." required />
        </div>
        <div class="input-group">
          <label for="text_template">Template de Texto</label>
          <textarea id="text_template" name="text_template" rows="6" placeholder="Olá {nome}, escreva sua mensagem aqui..." required></textarea>
          <div class="input-hint">Use {nome} para personalizar com o nome do destinatário</div>
        </div>
        <details class="html-template-section">
          <summary>
            <span>Template HTML Avançado</span>
            <div class="toggle-icon">
              <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <polyline points="6,9 12,15 18,9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
          </summary>
          <div class="input-group">
            <textarea id="html_template" name="html_template" rows="6" placeholder="<p>Olá {nome}, <strong>sua mensagem HTML aqui...</strong></p>"></textarea>
            <div class="input-hint">HTML opcional para emails mais ricos visualmente</div>
          </div>
        </details>
      </div>

      <div class="form-section">
        <div class="section-header">
          <div class="section-icon">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M4 4H20C21.1 4 22 4.9 22 6V18C22 19.1 21.1 20 20 20H4C2.9 20 2 19.1 2 18V6C2 4.9 2.9 4 4 4Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <polyline points="22,6 12,13 2,6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <h3>Informações do Remetente</h3>
        </div>
        <p class="muted" style="margin-top:-4px;margin-bottom:12px">O envio será feito pelo seu Gmail via SMTP. Suas respostas irão para o email informado abaixo (Reply-To).</p>
        <div class="alert warning" style="margin-bottom:15px;padding:10px 15px;border-radius:8px;background-color:rgba(245, 158, 11, 0.1);border:1px solid rgba(245, 158, 11, 0.3);">
          <strong>⚠️ Aviso:</strong> Na Vercel, o envio é limitado a 5 emails por requisição devido às restrições de ambiente serverless. Para enviar mais emails, faça múltiplas requisições.
        </div>
        <div class="grid-2">
          <div class="input-group">
            <label for="from_name">Nome do Remetente</label>
            <input type="text" id="from_name" name="from_name" placeholder="Seu Nome ou Empresa" autocomplete="name" />
          </div>
          <div class="input-group">
            <label for="reply_to">Seu email para receber respostas</label>
            <input type="email" id="reply_to" name="reply_to" placeholder="voce@dominio.com" autocomplete="email" required />
            <small class="muted">As respostas irão para este endereço (Reply-To).</small>
          </div>
        </div>
      </div>

      <div class="form-section">
        <div class="section-header">
          <div class="section-icon">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
              <polyline points="12,6 12,12 16,14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <h3>Limite Diário</h3>
        </div>
        <div class="input-group">
          <label for="daily_limit">Máximo de emails por dia</label>
          <input type="number" id="daily_limit" name="daily_limit" value="100" min="1" max="100" />
          <div class="input-hint">Limite máximo: 100 emails por dia</div>
        </div>
      </div>

      <div class="form-actions">
        <button type="submit" id="send-btn" class="send-button">
          <span class="button-text">Enviar Campanha</span>
          <div class="button-icon">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <line x1="22" y1="2" x2="11" y2="13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <polygon points="22,2 15,22 11,13 2,9 22,2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div class="loading-spinner">
            <div class="spinner"></div>
          </div>
        </button>
      </div>
    </form>

    <div class="results-section">
      <div id="status" class="status-display" role="status" aria-live="polite"></div>
      <div class="log-container">
        <div class="log-header">
          <h4>Log de Envio</h4>
          <button type="button" class="clear-log" onclick="document.getElementById('log').textContent = ''">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <polyline points="3,6 5,6 21,6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M8 6V4C8 3.46957 8.21071 2.96086 8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6M19 6V20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 22 17 22H7C6.46957 22 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20V6H19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>
        <pre id="log" class="log-display"></pre>
      </div>
    </div>
  </div>

  <script src="main.js"></script>
</body>
</html>
